<div class="container">
  <!-- Header -->
  <div class="header">
    <h1>Admin Dashboard</h1>
    <a routerLink="/dashboard" class="back-link">Back to Files</a>
  </div>

  <!-- Navigation Tabs -->
  <div class="admin-nav">
    <a routerLink="/metrics" class="nav-tab">Metrics</a>
    <a routerLink="/users" class="nav-tab active">Users</a>
    <a routerLink="/pending" class="nav-tab">Pending</a>
    <a routerLink="/denied" class="nav-tab">Denied</a>
    <a routerLink="/uploads" class="nav-tab">Uploads</a>
  </div>

  <div class="content-wrapper">
    <div class="scrollable-content">
      <!-- Users Table -->
      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Email</th>
              <th style="width: 15%; text-align: center;">Role</th>
              <th style="width: 15%; text-align: center;">Status</th>
              <th style="width: 15%; text-align: center;">Online Status</th>
              <th style="width: 30%; text-align: center;">Actions</th>
            </tr>
          </thead>

          <tbody>
            @for (user of users; track user.email) {
              <tr>
                <td>{{ user.email }}</td>

                <td style="text-align: center;">
                  <span
                    class="badge"
                    [ngClass]="user.is_admin ? 'role-admin' : 'role-user'"
                  >
                    {{ user.is_admin ? 'Admin' : 'User' }}
                  </span>
                </td>

                <td style="text-align: center;">
                  <span
                    class="badge"
                    [ngClass]="user.is_active ? 'status-active' : 'status-inactive'"
                  >
                    {{ user.is_active ? 'Active' : 'Inactive' }}
                  </span>
                </td>

                <td style="text-align: center;">
                  <span
                    class="online-status"
                    [ngClass]="user.online_status ? 'online' : 'offline'"
                  ></span>
                  {{ user.online_status ? 'Online' : 'Offline' }}
                </td>

                <td style="text-align: center;">
                  @if (user.email !== currentUserEmail) {
                    <button
                      class="action-btn make-admin"
                      [ngClass]="user.is_admin ? 'remove-admin' : 'make-admin'"
                      (click)="toggleRole(user.email)"
                    >
                      {{ user.is_admin ? 'Remove Admin' : 'Make Admin' }}
                    </button>

                    <button
                      class="action-btn deactivate-btn"
                      [ngClass]="user.is_active ? 'deactivate-user' : 'activate-user'"
                      (click)="toggleStatus(user.email)"
                    >
                      {{ user.is_active ? 'Deactivate' : 'Activate' }}
                    </button>
                  } @else {
                    <span>(You)</span>
                  }
                </td>
              </tr>
            }

            @if (users.length === 0) {
              <tr>
                <td colspan="5" style="text-align: center; color: #5f6368; padding: 30px;">
                  No users found.
                </td>
              </tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
